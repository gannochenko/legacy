(()=>{var e={689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupEntity=void 0,t.GroupEntity=class{}},977:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(689),t)},58:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UserRoleEnum=void 0,(r=t.UserRoleEnum||(t.UserRoleEnum={})).admin="admin",r.contributor="contributor",r.cicd="cicd"},422:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(58),t)},896:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(977),t),n(r(422),t)},198:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.RolesGuard=void 0;const i=r(481),s=r(143),a=r(896);let c=class{constructor(e){this.reflector=e}canActivate(e){const t=this.reflector.get("roles",e.getHandler());if(!t)return!0;const r=e.switchToHttp().getRequest().user;return!(!r||!r.roles)&&(!!r.roles.includes(a.UserRoleEnum.admin)||((e,t)=>e.filter((e=>t.includes(e))).length>0)(t,r.roles))}};c=o([(0,i.Injectable)(),n("design:paramtypes",[s.Reflector])],c),t.RolesGuard=c},179:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrapServer=void 0;const n=r(143),i=r(481),s=(o(r(806)),r(315)),a=r(672),c=r(188),l=o(r(860)),u=r(431),d=["multipart/form-data","image/png","image/jpg"];let p;t.bootstrapServer=async()=>{if(!p){const e=(0,l.default)(),t=await n.NestFactory.create(u.ApplicationModule,new c.ExpressAdapter(e));t.setGlobalPrefix("auth"),t.useGlobalPipes(new i.ValidationPipe({transform:!0,whitelist:!0})),t.use((0,a.eventContext)()),await t.init(),p=(0,s.createServer)(e,void 0,d)}return p}},925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APIKeyAuthenticationMiddleware=void 0;const o=r(58);t.APIKeyAuthenticationMiddleware=class{use(e,t,r){var n;const i=e.headers["x-api-key"]||"";let s=[];i===process.env.CONTRIBUTOR_API_KEY&&(s=[o.UserRoleEnum.contributor]),i===process.env.CICD_API_KEY&&(s=[o.UserRoleEnum.cicd]),s.length&&(e.user={...null!==(n=e.user)&&void 0!==n?n:{},roles:s}),r()}}},431:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationModule=void 0;const n=r(481),i=r(143),s=r(198),a=r(56),c=r(501),l=r(925);let u=class{configure(e){e.apply(l.APIKeyAuthenticationMiddleware).forRoutes({path:"*",method:n.RequestMethod.POST})}};u=o([(0,n.Module)({imports:[a.GroupModule,c.OptionsModule],providers:[{provide:i.APP_GUARD,useClass:s.RolesGuard}]})],u),t.ApplicationModule=u},260:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupController=void 0;const s=r(481),a=r(813),c=r(897),l=r(475),u=r(896);let d=class{constructor(e){this.service=e}async create(e){return this.service.create(e)}async findAll({limit:e,lastId:t}){return this.service.findAll({limit:e,lastId:t})}async findOne(e){const t=await this.service.getById(e);if(!t.data)throw new s.HttpException("Not found",s.HttpStatus.NOT_FOUND);return t}};o([(0,s.Post)("create"),i(0,(0,s.Body)()),n("design:type",Function),n("design:paramtypes",[c.CreateDto]),n("design:returntype",Promise)],d.prototype,"create",null),o([(0,s.Post)("findall"),(0,l.Roles)(u.UserRoleEnum.contributor,u.UserRoleEnum.cicd),i(0,(0,s.Query)()),n("design:type",Function),n("design:paramtypes",[c.FindDto]),n("design:returntype",Promise)],d.prototype,"findAll",null),o([(0,s.Post)("find/:id"),(0,l.Roles)(u.UserRoleEnum.contributor,u.UserRoleEnum.cicd),i(0,(0,s.Param)("id")),n("design:type",Function),n("design:paramtypes",[String]),n("design:returntype",Promise)],d.prototype,"findOne",null),d=o([(0,s.Controller)(),n("design:paramtypes",[a.GroupService])],d),t.GroupController=d},897:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.FindDto=t.UpdateDto=t.CreateDto=void 0;const i=r(849);class s{}o([(0,i.IsString)(),(0,i.MinLength)(10,{message:"Name is too short"}),n("design:type",String)],s.prototype,"name",void 0),o([(0,i.IsString)(),n("design:type",String)],s.prototype,"content",void 0),t.CreateDto=s,t.UpdateDto=class{};class a{}o([(0,i.IsString)(),(0,i.IsOptional)(),(0,i.Max)(50),n("design:type",Number)],a.prototype,"limit",void 0),o([(0,i.IsString)(),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"lastId",void 0),t.FindDto=a},216:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(260),t)},911:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupModule=void 0;const n=r(481),i=r(216),s=r(813),a=r(501);let c=class{};c=o([(0,n.Module)({imports:[a.OptionsModule],controllers:[i.GroupController],providers:[s.GroupService],exports:[s.GroupService]})],c),t.GroupModule=c},813:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupService=void 0;const i=r(481),s=r(828),a=r(336),c=r(438),l=r(34),u=r(136),d=r(159),p=r(153),f=new a.DynamoDB.DocumentClient({...l.awsOptions,apiVersion:"2012-08-10"}),v=null!=="prussiascan.auth.api_GroupCollection"?"prussiascan.auth.api_GroupCollection":"";let y=class{constructor(e){this.optionsService=e}async create(e){const{name:t}=e,r={id:(0,s.v4)(),slug:(0,c.makeSlug)(t),name:t,createdAt:(new Date).toISOString(),version:1};try{await f.put({TableName:v,Item:r,ReturnConsumedCapacity:"TOTAL"}).promise(),await this.optionsService.set(p.OptionCodes.dataUpdated,"1")}catch(e){throw console.error(e),new i.InternalServerErrorException("Could not create an object")}return{data:r,aux:{}}}async findAll({limit:e,lastId:t}={}){var r,o,n;try{const i=await f.scan({TableName:v,Limit:e,ExclusiveStartKey:t?{id:t}:void 0}).promise();return{data:null!==(r=null==i?void 0:i.Items)&&void 0!==r?r:[],aux:{lastId:null!==(n=null===(o=null==i?void 0:i.LastEvaluatedKey)||void 0===o?void 0:o.id)&&void 0!==n?n:null}}}catch(e){throw console.error(e),new i.InternalServerErrorException("Could not query objects")}}async getById(e){var t;return{data:null!==(t=await this.getItem(e))&&void 0!==t?t:null,aux:{}}}async isExists(e){return!!await this.getItem(e,["id"])}async getItem(e,t){var r;try{const o=await f.get({TableName:v,Key:{id:e},...t?{AttributesToGet:t}:{}}).promise();return null!==(r=null==o?void 0:o.Item)&&void 0!==r?r:null}catch(e){throw console.error(e),new i.InternalServerErrorException("Could not get an element")}}async updateItem(e,t,r="Could not update item"){return(0,u.tryExecute)((async()=>{await f.update({TableName:v,Key:{id:e},UpdateExpression:`SET ${t.UpdateExpression}, updatedAt = :u, version = if_not_exists(version, :vs) + :vinc`,ExpressionAttributeValues:{...t.ExpressionAttributeValues,":u":(new Date).toISOString(),":vs":1,":vinc":1},ReturnValues:"UPDATED_NEW"}).promise(),await this.optionsService.set(p.OptionCodes.dataUpdated,"1")}),r)}};y=o([(0,i.Injectable)(),n("design:paramtypes",[d.OptionsService])],y),t.GroupService=y},56:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(911),t)},934:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsModule=void 0;const n=r(481),i=r(159);let s=class{};s=o([(0,n.Module)({providers:[i.OptionsService],exports:[i.OptionsService]})],s),t.OptionsModule=s},159:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=void 0;const n=r(481),i=r(336),s=r(34),a=new i.DynamoDB.DocumentClient({...s.awsOptions,apiVersion:"2012-08-10"}),c=null!=="prussiascan.auth.api_Flags"?"prussiascan.auth.api_Flags":"";let l=class{async set(e,t){const r={code:e,value:t};try{await a.put({TableName:c,Item:r,ReturnConsumedCapacity:"TOTAL"}).promise()}catch(e){throw console.error(e),new n.InternalServerErrorException("Could not set a value")}return{data:r.value,aux:{}}}async get(e){var t,r;try{const o=await a.get({TableName:c,Key:{code:e}}).promise();return null!==(r=null===(t=null==o?void 0:o.Item)||void 0===t?void 0:t.value)&&void 0!==r?r:null}catch(e){throw console.error(e),new n.InternalServerErrorException("Could not get an value")}}};l=o([(0,n.Injectable)()],l),t.OptionsService=l},501:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(934),t)},153:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptionCodes=void 0,(t.OptionCodes||(t.OptionCodes={})).dataUpdated="DATA_UPDATED"},475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Roles=void 0;const o=r(481);t.Roles=(...e)=>(0,o.SetMetadata)("roles",e)},34:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.awsOptions=void 0,t.awsOptions={endpoint:"http://localhost:4566",region:"eu-central-1",accessKeyId:"local",secretAccessKey:"local"}},136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tryExecute=void 0;const o=r(481);t.tryExecute=async(e,t="")=>{try{return await e()}catch(e){throw console.error(e),new o.InternalServerErrorException(t)}}},438:(e,t,r)=>{const o=r(118),n=e=>o(e).toLowerCase().trim().replace(/(\s)+/g,"-").replace(/(\.)+/g,"_").replace(/[^a-zA-Z0-9-]/g,"").replace(/(-)+/g,"-"),i=e=>e.replace(/(-)+/g,"-");e.exports.makeSlug=(e,t="",r=45)=>{const o=`${n(e)}`,s=`-${n(t)}`,a=`-${Math.round(1e5*Math.random())}`;return o.length>r?i(o.substr(0,25).concat(a)):`${o}-${s}`.length>r?i(`${o}${a}`):i(`${o}${s}${a}`)}},481:e=>{"use strict";e.exports=require("@nestjs/common")},143:e=>{"use strict";e.exports=require("@nestjs/core")},188:e=>{"use strict";e.exports=require("@nestjs/platform-express")},336:e=>{"use strict";e.exports=require("aws-sdk")},315:e=>{"use strict";e.exports=require("aws-serverless-express")},672:e=>{"use strict";e.exports=require("aws-serverless-express/middleware")},849:e=>{"use strict";e.exports=require("class-validator")},860:e=>{"use strict";e.exports=require("express")},806:e=>{"use strict";e.exports=require("helmet")},118:e=>{"use strict";e.exports=require("latinize")},828:e=>{"use strict";e.exports=require("uuid")}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";r.r(o),r.d(o,{handler:()=>n});var e=r(315),t=r(179);const n=async(r,o)=>{const n=await(0,t.bootstrapServer)();return(0,e.proxy)(n,r,o,"PROMISE").promise}})();var n=exports;for(var i in o)n[i]=o[i];o.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();