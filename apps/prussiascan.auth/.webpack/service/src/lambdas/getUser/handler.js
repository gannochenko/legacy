(()=>{"use strict";var e={583:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.awsOptions=void 0,r.awsOptions={endpoint:"http://localhost:4566",region:"eu-central-1",accessKeyId:"local",secretAccessKey:"local"}},523:function(e,r,t){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.fn=void 0;const s=t(336),n=o(t(344)),a=t(583),l=new s.DynamoDB.DocumentClient({...a.awsOptions,apiVersion:"2012-08-10"}),i=null!=="prussiascan.auth_Users"?"prussiascan.auth_Users":"";r.fn=async({token:e})=>{var r,t;const o={data:{},errors:[],revoke:!1};try{const{userId:s}=n.default.verify(e,"really-secret-secret"),a=await l.get({TableName:i,Key:{id:s},AttributesToGet:["id","roles"]}).promise();(null==a?void 0:a.Item)?o.data={id:s,type:"user",attributes:{roles:null!==(t=null===(r=null==a?void 0:a.Item)||void 0===r?void 0:r.roles)&&void 0!==t?t:[]}}:(o.errors.push({message:"User not found"}),o.revoke=!0)}catch(e){o.errors.push({message:"Token expired"}),o.revoke=!0}return o}},336:e=>{e.exports=require("aws-sdk")},344:e=>{e.exports=require("jsonwebtoken")}},r={};function t(o){var s=r[o];if(void 0!==s)return s.exports;var n=r[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{t.r(o),t.d(o,{handler:()=>s});var e=t(523);const r=(e,r)=>(console.log(r),{statusCode:e,headers:{"Content-Type":"application/json; charset=utf-8","Access-Control-Allow-Origin":process.env.CORS},body:JSON.stringify(r)}),s=(t,o,s)=>{const{body:n,httpMethod:a,headers:l,queryStringParameters:i,requestContext:{path:u,domainName:d}}=t,{functionName:c,memoryLimitInMB:p,getRemainingTimeInMillis:v}=o;let y={};try{y=JSON.parse(n)}catch(e){return s(null,r(400))}return(0,e.fn)(y).then((e=>{e.errors.length?s(null,r(400,e)):s(null,r(200,e))})).catch((e=>{console.error(e),s(null,r(500))})),!0}})();var s=exports;for(var n in o)s[n]=o[n];o.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();